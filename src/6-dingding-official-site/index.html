<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>钉钉官网动效</title>
    <script src="../3-find-x3-mars/threejs/three.min.js"></script>
  </head>
  <body>
    <script>
      // 以下是一个基本的 three.js 波浪动画，你可以按照自己的需求进行修改和扩展。
      // 首先，设置场景、相机和渲染器：
      var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      camera.position.z = 5;
      var renderer = new THREE.WebGLRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // 接下来，创建一个平面，用于放置波浪：
      var plane = new THREE.PlaneBufferGeometry(5, 5, 50, 50);

      // 为平面添加顶点位移和动画效果，这里使用了 sin 函数模拟波浪：
      var count = plane.attributes.position.count;
      var distance = 1;
      var positions = plane.attributes.position.array;
      var blancs = [];
      for (var i = 0; i < count; i++) {
        var x = positions[i * 3];
        var y = Math.random() * distance;
        var z = positions[i * 3 + 2];
        positions[i * 3 + 1] = y;
        blancs.push(y);
      }
      planeWave = plane.clone();
      console.log('planeWave', planeWave)
      planeWave.position.y = -1;
      var waveCount = planeWave.attributes.position.count;
      var planeWavePositions = planeWave.attributes.position.array;
      var waveMovement = 0;
      var waveSpeed = 0.1;
      var waveHeight = 0.1;

      // 创建一个网格对象，将平面和平面波浪添加到场景中：
      var material = new THREE.MeshBasicMaterial({
        color: 0x0000ff,
        side: THREE.DoubleSide,
      });
      var mesh = new THREE.Mesh(plane, material);
      var mesh1 = new THREE.Mesh(planeWave, material);
      scene.add(mesh);
      scene.add(mesh1);

      // 定义一个更新函数，每一帧修改网格对象的顶点位移和波浪效果：

      function update() {
        waveMovement -= waveSpeed;
        for (var i = 0; i < waveCount; i++) {
          var x = planeWavePositions[i * 3];
          var y = blancs[i] * waveHeight;
          var z = planeWavePositions[i * 3 + 2];
          planeWavePositions[i * 3 + 1] = y * Math.sin(i + waveMovement);
        }
        planeWave.geometry.attributes.position.needsUpdate = true;
        renderer.render(scene, camera);
        requestAnimationFrame(update);
      }
      update();

      // 最后还需要调用 animate 方法来开始动画：

      function animate() {
        renderer.render(scene, camera);
        requestAnimationFrame(animate);
      }
      animate();
    </script>
  </body>
</html>
